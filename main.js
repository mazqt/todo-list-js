(()=>{"use strict";const e=class{constructor(e,t,n,i,r){this.title=e,this.project=t,this.dueDate=n,this.priority=i,this.description=r}addNote(e){null==this.notes?this.notes=[e]:this.notes.push(e)}},t=function(){let t={},i=[];n("localStorage")?(null===localStorage.getItem("myTasks")&&(t["Get started"]=[new e("My task","Get started",(new Date).toJSON().slice(0,10),"high","Time to start logging the things I need to do!")],localStorage.setItem("myTasks",JSON.stringify(t))),t=JSON.parse(localStorage.getItem("myTasks")),Object.values(t).forEach((n=>{t[n[0].project]=n.map((t=>(Object.assign(new Date,t.dueDate),t=Object.assign(new e,t),i.push(t),t)))}))):i=[new e("My task","Get started",new Date,"high","Time to start logging the things I need to do!")];const r=function(){n("localStorage")&&localStorage.setItem("myTasks",JSON.stringify(t))};return{retrieveTasks:function(){return i},saveTask:function(e){void 0===t[e.project]?(t[e.project]=[],t[e.project].push(e)):t[e.project].push(e),i.push(e),r()},taskIndex:function(e){return t[e.project].indexOf(e)},deleteTask:function(e,n){t[n].splice(e,1),r()},saveTasks:r,editTask:function(e,n,i){t[e.project][i].title=n.get("title"),t[e.project][i].project=n.get("project"),t[e.project][i].dueDate=n.get("date"),t[e.project][i].priority=n.get("priority"),t[e.project][i].description=n.get("description")}}}();function n(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}const i=function(){const n=document.getElementById("listOfTasks"),i=document.getElementById("newtask"),r=function(e){n.innerHTML="";const i=document.createElement("div");i.classList.toggle("taskList"),e.forEach((e=>{const n=document.createElement("div");let r=t.taskIndex(e);n.setAttribute("index",r),n.classList.toggle(e.priority);const o=document.createElement("h2");o.innerText=e.title;const a=document.createElement("p");a.innerText=e.dueDate.slice(0,10);const c=document.createElement("p");if(c.innerText=e.description,n.appendChild(o),n.appendChild(a),n.appendChild(c),null!=e.notes){const t=document.createElement("ul");e.notes.forEach((e=>{const n=document.createElement("li");n.innerText=e,t.appendChild(n)})),n.appendChild(t)}const d=document.createElement("button");d.innerText="Delete task",d.addEventListener("click",(function(){confirm("Are you sure you wanna delete this task?")&&(console.log(r),t.deleteTask(r,e.project),location.reload())})),n.appendChild(d);let l=s(e,r);const u=document.createElement("button");u.innerText="Edit task",u.addEventListener("click",(function(){l.classList.toggle("hidden")})),n.appendChild(u),n.appendChild(l),i.appendChild(n)})),n.appendChild(i)},s=function(e,n){const i=document.createElement("form");i.classList.toggle("hidden");const r=document.createElement("label");r.innerText="Title: ",i.appendChild(r);const s=document.createElement("input");s.setAttribute("value",e.title),s.setAttribute("type","text"),s.setAttribute("name","title"),s.setAttribute("required",""),i.appendChild(s);const o=document.createElement("label");o.innerText="Project: ",i.appendChild(o);const a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("name","project"),a.setAttribute("value",e.project),a.setAttribute("required",""),a.setAttribute("list","projects");const c=document.createElement("datalist");c.setAttribute("id","projects");const d=document.createElement("option");d.setAttribute("value","Default"),c.appendChild(d),a.appendChild(c),i.appendChild(a);const l=document.createElement("label");l.innerText="Done by: ",i.appendChild(l);const u=document.createElement("input");u.setAttribute("value",e.dueDate),u.setAttribute("type","date"),u.setAttribute("name","date"),u.setAttribute("required",""),u.setAttribute("min",(new Date).toJSON().slice(0,10)),u.setAttribute("max",new Date((new Date).setFullYear((new Date).getFullYear()+1)).toJSON().slice(0,10)),i.appendChild(u);const p=document.createElement("label");p.innerText="Priority: ",i.appendChild(p);const m=document.createElement("select");m.setAttribute("name","priority"),m.setAttribute("required","");const h=document.createElement("option");h.setAttribute("value","high"),h.innerText="High",m.appendChild(h);const b=document.createElement("option");b.setAttribute("value","medium"),b.innerText="Medium",m.appendChild(b);const E=document.createElement("option");E.setAttribute("value","low"),E.innerText="Low",m.appendChild(E),i.appendChild(m),"high"==e.priority?h.setAttribute("selected",""):"medium"==e.priority?b.setAttribute("selected",""):E.setAttribute("selected","");const A=document.createElement("label");A.innerText="Description: ",i.appendChild(A);const g=document.createElement("input");g.setAttribute("value",e.description),g.setAttribute("name","description"),g.setAttribute("type","text"),g.setAttribute("required",""),i.appendChild(g);const T=document.createElement("button");return T.innerText="Edit task",T.setAttribute("type","submit"),i.appendChild(T),i.addEventListener("submit",(function(i){i.preventDefault();let r=new FormData(this);confirm("Are you sure you want to edit this task?")&&(t.editTask(e,r,n),t.saveTasks(),location.reload())})),i};return{renderTasks:r,renderNewForm:function(){const n=document.createElement("form"),s=document.createElement("label");s.innerText="Title: ",n.appendChild(s);const o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("name","title"),o.setAttribute("required",""),n.appendChild(o);const a=document.createElement("label");a.innerText="Project: ",n.appendChild(a);const c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("name","project"),c.setAttribute("required",""),c.setAttribute("list","projects");const d=document.createElement("datalist");d.setAttribute("id","projects"),c.appendChild(d),n.appendChild(c);const l=document.createElement("label");l.innerText="Done by: ",n.appendChild(l);const u=document.createElement("input");u.setAttribute("value",(new Date).toJSON().slice(0,10)),u.setAttribute("type","date"),u.setAttribute("name","date"),u.setAttribute("required",""),u.setAttribute("min",(new Date).toJSON().slice(0,10)),u.setAttribute("max",new Date((new Date).setFullYear((new Date).getFullYear()+1)).toJSON().slice(0,10)),n.appendChild(u);const p=document.createElement("label");p.innerText="Priority: ",n.appendChild(p);const m=document.createElement("select");m.setAttribute("name","priority"),m.setAttribute("required","");const h=document.createElement("option");h.setAttribute("value","high"),h.innerText="High",m.appendChild(h);const b=document.createElement("option");b.setAttribute("value","medium"),b.innerText="Medium",m.appendChild(b);const E=document.createElement("option");E.setAttribute("value","low"),E.innerText="Low",m.appendChild(E),n.appendChild(m);const A=document.createElement("label");A.innerText="Description: ",n.appendChild(A);const g=document.createElement("input");g.setAttribute("name","description"),g.setAttribute("type","text"),g.setAttribute("required",""),n.appendChild(g);const T=document.createElement("button");T.innerText="Create new task",T.setAttribute("type","submit"),n.appendChild(T),n.addEventListener("submit",(function(i){i.preventDefault();let s=new FormData(this),o=new e(s.get("title"),s.get("project"),s.get("date"),s.get("priority"),s.get("description"));t.saveTask(o),r(t.retrieveTasks()),n.reset()})),i.appendChild(n)}}}(),r=t.retrieveTasks();i.renderTasks(r),i.renderNewForm()})();